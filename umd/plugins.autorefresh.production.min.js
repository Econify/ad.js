this._ADJS=this._ADJS||{},this._ADJS.Plugins=this._ADJS.Plugins||{},this._ADJS.Plugins.AutoRefresh=function(){"use strict";var t,e=(function(t,e){e.VISIBILITYCHANGE="visibilityChange",e.ENTERVIEWPORT="enterViewport",e.FULLYENTERVIEWPORT="fullyEnterViewport",e.EXITVIEWPORT="exitViewport",e.PARTIALLYEXITVIEWPORT="partiallyExitViewport",e.LOCATIONCHANGE="locationChange",e.STATECHANGE="stateChange",e.eventTypes=[e.VISIBILITYCHANGE,e.ENTERVIEWPORT,e.FULLYENTERVIEWPORT,e.EXITVIEWPORT,e.PARTIALLYEXITVIEWPORT,e.LOCATIONCHANGE,e.STATECHANGE],e.isOnServer="undefined"==typeof window,e.isInBrowser=!e.isOnServer,e.defaultOffsets={top:0,bottom:0}}(t={exports:{}},t.exports),t.exports),{VISIBILITYCHANGE:i,ENTERVIEWPORT:s,FULLYENTERVIEWPORT:o,EXITVIEWPORT:n,PARTIALLYEXITVIEWPORT:r,LOCATIONCHANGE:h,STATECHANGE:c,eventTypes:a,defaultOffsets:l}=(e.VISIBILITYCHANGE,e.ENTERVIEWPORT,e.FULLYENTERVIEWPORT,e.EXITVIEWPORT,e.PARTIALLYEXITVIEWPORT,e.LOCATIONCHANGE,e.STATECHANGE,e.eventTypes,e.isOnServer,e.isInBrowser,e.defaultOffsets,e);function w(t,e,w){var p,u,d,m,f,I,v=this;this.watchItem=e,this.container=t,this.offsets=w?w===+w?{top:w,bottom:w}:{top:w.top||l.top,bottom:w.bottom||l.bottom}:l,this.callbacks={};for(var E=0,g=a.length;E<g;E++)v.callbacks[a[E]]=[];function b(t,e){if(0!==t.length)for(f=t.length;f--;)(I=t[f]).callback.call(v,e,v),I.isOne&&t.splice(f,1)}this.locked=!1,this.triggerCallbacks=function(t){switch(this.isInViewport&&!p&&b(this.callbacks[s],t),this.isFullyInViewport&&!u&&b(this.callbacks[o],t),this.isAboveViewport!==d&&this.isBelowViewport!==m&&(b(this.callbacks[i],t),u||this.isFullyInViewport||(b(this.callbacks[o],t),b(this.callbacks[r],t)),p||this.isInViewport||(b(this.callbacks[s],t),b(this.callbacks[n],t))),!this.isFullyInViewport&&u&&b(this.callbacks[r],t),!this.isInViewport&&p&&b(this.callbacks[n],t),this.isInViewport!==p&&b(this.callbacks[i],t),!0){case p!==this.isInViewport:case u!==this.isFullyInViewport:case d!==this.isAboveViewport:case m!==this.isBelowViewport:b(this.callbacks[c],t)}p=this.isInViewport,u=this.isFullyInViewport,d=this.isAboveViewport,m=this.isBelowViewport},this.recalculateLocation=function(){if(!this.locked){var t=this.top,e=this.bottom;if(this.watchItem.nodeName){var i=this.watchItem.style.display;"none"===i&&(this.watchItem.style.display="");for(var s=0,o=this.container;o.containerWatcher;)s+=o.containerWatcher.top-o.containerWatcher.container.viewportTop,o=o.containerWatcher.container;var n=this.watchItem.getBoundingClientRect();this.top=n.top+this.container.viewportTop-s,this.bottom=n.bottom+this.container.viewportTop-s,"none"===i&&(this.watchItem.style.display=i)}else this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=this.container.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom);this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,void 0===t&&void 0===e||this.top===t&&this.bottom===e||b(this.callbacks[h],null)}},this.recalculateLocation(),this.update(),p=this.isInViewport,u=this.isFullyInViewport,d=this.isAboveViewport,m=this.isBelowViewport}w.prototype={on:function(t,e,h){switch(!0){case t===i&&!this.isInViewport&&this.isAboveViewport:case t===s&&this.isInViewport:case t===o&&this.isFullyInViewport:case t===n&&this.isAboveViewport&&!this.isInViewport:case t===r&&this.isInViewport&&this.isAboveViewport:if(e.call(this,this.container.latestEvent,this),h)return}if(!this.callbacks[t])throw new Error("Tried to add a scroll monitor listener of type "+t+". Your options are: "+a.join(", "));this.callbacks[t].push({callback:e,isOne:h||!1})},off:function(t,e){if(!this.callbacks[t])throw new Error("Tried to remove a scroll monitor listener of type "+t+". Your options are: "+a.join(", "));for(var i,s=0;i=this.callbacks[t][s];s++)if(i.callback===e){this.callbacks[t].splice(s,1);break}},one:function(t,e){this.on(t,e,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<this.container.viewportTop,this.isBelowViewport=this.bottom>this.container.viewportBottom,this.isInViewport=this.top<this.container.viewportBottom&&this.bottom>this.container.viewportTop,this.isFullyInViewport=this.top>=this.container.viewportTop&&this.bottom<=this.container.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var t=this.container.watchers.indexOf(this);this.container.watchers.splice(t,1);for(var e=0,i=a.length;e<i;e++)this.callbacks[a[e]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var p=function(t){return function(e,i){this.on.call(this,t,e,i)}},u=0,d=a.length;u<d;u++){var m=a[u];w.prototype[m]=p(m)}var f=w,{isOnServer:I,isInBrowser:v,eventTypes:E}=e;function g(t){return I?0:t===document.body?window.innerHeight||document.documentElement.clientHeight:t.clientHeight}function b(t){return I?0:t===document.body?Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight):t.scrollHeight}function T(t){return I?0:t===document.body?window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop}var V=!1;if(v)try{var y=Object.defineProperty({},"passive",{get:function(){V=!0}});window.addEventListener("test",null,y)}catch(t){}const O=!!V&&{capture:!1,passive:!0};class L{constructor(t,e){var i,s,o,n=this;this.item=t,this.watchers=[],this.viewportTop=null,this.viewportBottom=null,this.documentHeight=b(t),this.viewportHeight=g(t),this.DOMListener=function(){L.prototype.DOMListener.apply(n,arguments)},this.eventTypes=E,e&&(this.containerWatcher=e.create(t)),this.update=function(){!function(){if(n.viewportTop=T(t),n.viewportBottom=n.viewportTop+n.viewportHeight,n.documentHeight=b(t),n.documentHeight!==i){for(s=n.watchers.length;s--;)n.watchers[s].recalculateLocation();i=n.documentHeight}}(),function(){for(o=n.watchers.length;o--;)n.watchers[o].update();for(o=n.watchers.length;o--;)n.watchers[o].triggerCallbacks()}()},this.recalculateLocations=function(){this.documentHeight=0,this.update()}}listenToDOM(){v&&(window.addEventListener?(this.item===document.body?window.addEventListener("scroll",this.DOMListener,O):this.item.addEventListener("scroll",this.DOMListener,O),window.addEventListener("resize",this.DOMListener)):(this.item===document.body?window.attachEvent("onscroll",this.DOMListener):this.item.attachEvent("onscroll",this.DOMListener),window.attachEvent("onresize",this.DOMListener)),this.destroy=function(){window.addEventListener?(this.item===document.body?(window.removeEventListener("scroll",this.DOMListener,O),this.containerWatcher.destroy()):this.item.removeEventListener("scroll",this.DOMListener,O),window.removeEventListener("resize",this.DOMListener)):(this.item===document.body?(window.detachEvent("onscroll",this.DOMListener),this.containerWatcher.destroy()):this.item.detachEvent("onscroll",this.DOMListener),window.detachEvent("onresize",this.DOMListener))})}destroy(){}DOMListener(t){this.setStateFromDOM(t)}setStateFromDOM(t){var e=T(this.item),i=g(this.item),s=b(this.item);this.setState(e,i,s,t)}setState(t,e,i,s){var o=e!==this.viewportHeight||i!==this.contentHeight;if(this.latestEvent=s,this.viewportTop=t,this.viewportHeight=e,this.viewportBottom=t+e,this.contentHeight=i,o){let t=this.watchers.length;for(;t--;)this.watchers[t].recalculateLocation()}this.updateAndTriggerWatchers(s)}updateAndTriggerWatchers(t){let e=this.watchers.length;for(;e--;)this.watchers[e].update();for(e=this.watchers.length;e--;)this.watchers[e].triggerCallbacks(t)}createCustomContainer(){return new L}createContainer(t){"string"==typeof t?t=document.querySelector(t):t&&t.length>0&&(t=t[0]);var e=new L(t,this);return e.setStateFromDOM(),e.listenToDOM(),e}create(t,e){"string"==typeof t?t=document.querySelector(t):t&&t.length>0&&(t=t[0]);var i=new f(this,t,e);return this.watchers.push(i),i}beget(t,e){return this.create(t,e)}}var A=L,{isInBrowser:R}=e,k=new A(R?document.body:null);k.setStateFromDOM(null),k.listenToDOM(),R&&(window.scrollMonitor=k);var H=k;class P extends Error{constructor(t,e){super(e),this.code=t,this.message=e}}class S{get name(){return this.constructor.name}constructor(t){if(!t)throw new P("Misconfiguration",`
An ad must be passed into the GenericPlugin class. If your Plugin inherits from GenericPlugin
and overrides the constructor make sure you are calling "super" and that you are passing in an
instance of an ad as the first parameter. Alternatively, you can hook into the onCreate method
which gets called by the constructor.

Example:
\```js
          class ExamplePlugin extends GenericPlugin {
            onCreate() {
              console.log('Example Plugin Started Succesfully');
            }
          }

          // Or

          class ExamplePlugin extends GenericPlugin {
            constructor(ad) {
              super(ad);

              console.log('Example Plugin Started Succesfully');
            }
          }
        \```	   `);this.ad=t}}const M=1e3;return class extends S{constructor(){super(...arguments),this.timeInView=0,this.isRefreshing=!1}afterRender(){this.startMonitoringViewability()}beforeClear(){this.stopMonitoringViewability()}beforeDestroy(){this.stopMonitoringViewability()}startMonitoringViewability(){if(this.watcher)return;const{container:t}=this.ad;this.watcher=H.create(t),this.timeInView=0,this.watcher.fullyEnterViewport(()=>{this.markAsInView()})}stopMonitoringViewability(){this.watcher&&this.watcher.exitViewport(()=>{this.markAsOutOfView(),this.watcher=void 0})}markAsInView(){if(this.timerReference)return;const{refreshRateInSeconds:t=30}=this.ad.configuration;this.timerReference=window.setInterval(async()=>{this.timeInView+=1,!this.isRefreshing&&this.timeInView>=t&&(this.isRefreshing=!0,await this.ad.refresh(),this.timeInView=0,this.isRefreshing=!1)},M)}markAsOutOfView(){this.timerReference&&(clearInterval(this.timerReference),this.timerReference=void 0)}}}();
//# sourceMappingURL=plugins.autorefresh.production.min.js.map
